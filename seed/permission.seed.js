const { Database } = require("arangojs");
const dotenv = require("dotenv");
const moment = require("moment");
const uuid = require("uuid").v4;
const ROLES = require("./constant").ROLES;
const PERMISSION_TITLE = require("./constant").PERMISSION_TITLE;
const PERMISSION_NULL_ATTRIBUTES =
  require("./constant").PERMISSION_NULL_ATTRIBUTES;
const SYSTEM_TYPE = require("./constant").SYSTEM_TYPE;
dotenv.config();

const db = new Database({
  url: process.env.DATABASE_HOSTNAME,
});
db.useDatabase(process.env.DATABASE_NAME || "");
db.useBasicAuth(process.env.DATABASE_USERNAME, process.env.DATABASE_PASSWORD);

const seed = async () => {
  const permissionCollection = await db.collection("permissions");
  const createAndSeed = async (collection) => {
    await collection.create();
    await collection.get();
    const records = [
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_ADMIN,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/my_workspace.svg",
        name: PERMISSION_TITLE.MY_WORKSPACE,
        accessable: true,
        created_at: moment(),
        number: 1,
        routes: [{ id: "2", accessable: true }],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_ADMIN,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/user_group.svg",
        name: PERMISSION_TITLE.USER_GROUP,
        created_at: moment(),
        number: 2,
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_ADMIN,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/brand.svg",
        name: PERMISSION_TITLE.USER_GROUP_BRAND,
        accessable: true,
        created_at: moment(),
        number: 3,
        parent_number: 2,
        routes: [
          { id: "1", accessable: true },
          { id: "4", accessable: true },
          { id: "3", accessable: true },
          { id: "5", accessable: true },
          { id: "9", accessable: true },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_ADMIN,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/design.svg",
        name: PERMISSION_TITLE.USER_GROUP_DESIGN,
        accessable: true,
        created_at: moment(),
        number: 4,
        parent_number: 2,
        routes: [
          { id: "12", accessable: true },
          { id: "13", accessable: true },
          { id: "14", accessable: true },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_ADMIN,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/project.svg",
        name: PERMISSION_TITLE.PROJECT,
        created_at: moment(),
        number: 5,
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_ADMIN,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/list.svg",
        name: PERMISSION_TITLE.PROJECT_LIST,
        accessable: true,
        created_at: moment(),
        number: 6,
        parent_number: 5,
        routes: [
          { id: "16", accessable: true },
          { id: "17", accessable: true },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_ADMIN,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/product.svg",
        name: PERMISSION_TITLE.PRODUCT,
        created_at: moment(),
        number: 7,
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_ADMIN,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/category.svg",
        name: PERMISSION_TITLE.PRODUCT_CATEGORY,
        accessable: true,
        created_at: moment(),
        number: 8,
        parent_number: 7,
        routes: [
          { id: "18", accessable: true },
          { id: "19", accessable: true },
          { id: "20", accessable: true },
          { id: "21", accessable: true },
          { id: "22", accessable: true },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_ADMIN,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/basis.svg",
        name: PERMISSION_TITLE.PRODUCT_BASIS,
        accessable: true,
        created_at: moment(),
        number: 9,
        parent_number: 7,
        routes: [
          { id: "23", accessable: true },
          { id: "24", accessable: true },
          { id: "25", accessable: true },
          { id: "26", accessable: true },
          { id: "27", accessable: true },
          { id: "28", accessable: true },
          { id: "29", accessable: true },
          { id: "30", accessable: true },
          { id: "31", accessable: true },
          { id: "32", accessable: true },
          { id: "33", accessable: true },
          { id: "34", accessable: true },
          { id: "35", accessable: true },
          { id: "36", accessable: true },
          { id: "37", accessable: true },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_ADMIN,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/attribute.svg",
        name: PERMISSION_TITLE.PRODUCT_ATTRIBUTE,
        accessable: true,
        created_at: moment(),
        number: 10,
        parent_number: 7,
        routes: [
          { id: "38", accessable: true },
          { id: "39", accessable: true },
          { id: "40", accessable: true },
          { id: "41", accessable: true },
          { id: "42", accessable: true },
          { id: "43", accessable: true },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_ADMIN,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/configuration.svg",
        name: PERMISSION_TITLE.PRODUCT_CONFIGURATION,
        accessable: true,
        created_at: moment(),
        number: 11,
        parent_number: 7,
        routes: [
          { id: "44", accessable: true },
          { id: "45", accessable: true },
          { id: "46", accessable: true },
          { id: "47", accessable: true },
          { id: "48", accessable: true },
          { id: "50", accessable: true },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_ADMIN,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/administration.svg",
        name: PERMISSION_TITLE.ADMINISTRATION,
        created_at: moment(),
        number: 12,
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_ADMIN,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/documentation.svg",
        name: PERMISSION_TITLE.ADMINISTRATION_DOCUMENTATION,
        accessable: true,
        created_at: moment(),
        number: 13,
        parent_number: 12,
        routes: [
          { id: "51", accessable: true },
          { id: "52", accessable: true },
          { id: "53", accessable: true },
          { id: "54", accessable: true },
          { id: "55", accessable: true },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_ADMIN,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/location.svg",
        name: PERMISSION_TITLE.ADMINISTRATION_LOCATION,
        accessable: true,
        created_at: moment(),
        number: 14,
        parent_number: 12,
        routes: [
          { id: "56", accessable: true },
          { id: "57", accessable: true },
          { id: "58", accessable: true },
          { id: "59", accessable: true },
          { id: "60", accessable: true },
          { id: "61", accessable: true },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_ADMIN,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/team_profile.svg",
        name: PERMISSION_TITLE.ADMINISTRATION_TEAM_PROFILE,
        accessable: true,
        created_at: moment(),
        number: 15,
        parent_number: 12,
        routes: [
          { id: "67", accessable: true },
          { id: "68", accessable: true },
          { id: "72", accessable: true },
          { id: "73", accessable: true },
          { id: "74", accessable: true },
          { id: "75", accessable: true },
          { id: "76", accessable: true },
          { id: "77", accessable: true },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_ADMIN,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/message.svg",
        name: PERMISSION_TITLE.ADMINISTRATION_MESSAGE,
        accessable: true,
        created_at: moment(),
        number: 16,
        parent_number: 12,
        routes: [
          { id: "78", accessable: true },
          { id: "79", accessable: true },
          { id: "80", accessable: true },
          { id: "81", accessable: true },
          { id: "82", accessable: true },
          { id: "83", accessable: true },
          { id: "84", accessable: true },
          { id: "85", accessable: true },
          { id: "86", accessable: true },
          { id: "87", accessable: true },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_ADMIN,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/revenue.svg",
        name: PERMISSION_TITLE.ADMINISTRATION_REVENUE,
        accessable: true,
        created_at: moment(),
        number: 17,
        parent_number: 12,
        routes: [
          { id: "88", accessable: true },
          { id: "89", accessable: true },
          { id: "90", accessable: true },
          { id: "91", accessable: true },
          { id: "95", accessable: true },
        ],
      },
      //consultant team
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_CONSULTANT_TEAM,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/my_workspace.svg",
        name: PERMISSION_TITLE.MY_WORKSPACE,
        accessable: true,
        created_at: moment(),
        number: 1,
        routes: [{ id: "2", accessable: true }],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_CONSULTANT_TEAM,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/user_group.svg",
        name: PERMISSION_TITLE.USER_GROUP,
        created_at: moment(),
        number: 2,
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_CONSULTANT_TEAM,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/brand.svg",
        name: PERMISSION_TITLE.USER_GROUP_BRAND,
        accessable: false,
        created_at: moment(),
        number: 3,
        parent_number: 2,
        routes: [
          { id: "1", accessable: false },
          { id: "4", accessable: false },
          { id: "3", accessable: false },
          { id: "5", accessable: false },
          { id: "9", accessable: false },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_CONSULTANT_TEAM,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/design.svg",
        name: PERMISSION_TITLE.USER_GROUP_DESIGN,
        accessable: false,
        created_at: moment(),
        number: 4,
        parent_number: 2,
        routes: [
          { id: "12", accessable: false },
          { id: "13", accessable: false },
          { id: "14", accessable: false },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_CONSULTANT_TEAM,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/project.svg",
        name: PERMISSION_TITLE.PROJECT,
        created_at: moment(),
        number: 5,
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_CONSULTANT_TEAM,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/list.svg",
        name: PERMISSION_TITLE.PROJECT_LIST,
        accessable: false,
        created_at: moment(),
        number: 6,
        parent_number: 5,
        routes: [
          { id: "16", accessable: false },
          { id: "17", accessable: false },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_CONSULTANT_TEAM,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/product.svg",
        name: PERMISSION_TITLE.PRODUCT,
        created_at: moment(),
        number: 7,
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_CONSULTANT_TEAM,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/category.svg",
        name: PERMISSION_TITLE.PRODUCT_CATEGORY,
        accessable: false,
        created_at: moment(),
        number: 8,
        parent_number: 7,
        routes: [
          { id: "18", accessable: false },
          { id: "19", accessable: false },
          { id: "20", accessable: false },
          { id: "21", accessable: false },
          { id: "22", accessable: false },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_CONSULTANT_TEAM,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/basis.svg",
        name: PERMISSION_TITLE.PRODUCT_BASIS,
        accessable: true,
        created_at: moment(),
        number: 9,
        parent_number: 7,
        routes: [
          { id: "23", accessable: true },
          { id: "24", accessable: true },
          { id: "25", accessable: true },
          { id: "26", accessable: true },
          { id: "27", accessable: true },
          { id: "28", accessable: true },
          { id: "29", accessable: true },
          { id: "30", accessable: true },
          { id: "31", accessable: true },
          { id: "32", accessable: true },
          { id: "33", accessable: true },
          { id: "34", accessable: true },
          { id: "35", accessable: true },
          { id: "36", accessable: true },
          { id: "37", accessable: true },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_CONSULTANT_TEAM,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/attribute.svg",
        name: PERMISSION_TITLE.PRODUCT_ATTRIBUTE,
        accessable: true,
        created_at: moment(),
        number: 10,
        parent_number: 7,
        routes: [
          { id: "38", accessable: true },
          { id: "39", accessable: true },
          { id: "40", accessable: true },
          { id: "41", accessable: true },
          { id: "42", accessable: true },
          { id: "43", accessable: true },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_CONSULTANT_TEAM,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/configuration.svg",
        name: PERMISSION_TITLE.PRODUCT_CONFIGURATION,
        accessable: true,
        created_at: moment(),
        number: 11,
        parent_number: 7,
        routes: [
          { id: "44", accessable: true },
          { id: "45", accessable: true },
          { id: "46", accessable: true },
          { id: "47", accessable: true },
          { id: "48", accessable: true },
          { id: "50", accessable: true },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        routes: [],
        role_id: ROLES.TISC_CONSULTANT_TEAM,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/administration.svg",
        name: PERMISSION_TITLE.ADMINISTRATION,
        created_at: moment(),
        number: 12,
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_CONSULTANT_TEAM,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/documentation.svg",
        name: PERMISSION_TITLE.ADMINISTRATION_DOCUMENTATION,
        accessable: false,
        created_at: moment(),
        number: 13,
        parent_number: 12,
        routes: [
          { id: "51", accessable: false },
          { id: "52", accessable: false },
          { id: "53", accessable: false },
          { id: "54", accessable: false },
          { id: "55", accessable: false },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_CONSULTANT_TEAM,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/location.svg",
        name: PERMISSION_TITLE.ADMINISTRATION_LOCATION,
        accessable: false,
        created_at: moment(),
        number: 14,
        parent_number: 12,
        routes: [
          { id: "56", accessable: false },
          { id: "57", accessable: false },
          { id: "58", accessable: false },
          { id: "59", accessable: false },
          { id: "60", accessable: false },
          { id: "61", accessable: false },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_CONSULTANT_TEAM,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/team_profile.svg",
        name: PERMISSION_TITLE.ADMINISTRATION_TEAM_PROFILE,
        accessable: false,
        created_at: moment(),
        number: 15,
        parent_number: 12,
        routes: [
          { id: "67", accessable: false },
          { id: "68", accessable: false },
          { id: "72", accessable: false },
          { id: "73", accessable: false },
          { id: "74", accessable: false },
          { id: "75", accessable: false },
          { id: "76", accessable: false },
          { id: "77", accessable: false },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_CONSULTANT_TEAM,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/message.svg",
        name: PERMISSION_TITLE.ADMINISTRATION_MESSAGE,
        accessable: false,
        created_at: moment(),
        number: 16,
        parent_number: 12,
        routes: [
          { id: "78", accessable: false },
          { id: "79", accessable: false },
          { id: "80", accessable: false },
          { id: "81", accessable: false },
          { id: "82", accessable: false },
          { id: "83", accessable: false },
          { id: "84", accessable: false },
          { id: "85", accessable: false },
          { id: "86", accessable: false },
          { id: "87", accessable: false },
        ],
      },
      {
        ...PERMISSION_NULL_ATTRIBUTES,
        id: uuid(),
        role_id: ROLES.TISC_CONSULTANT_TEAM,
        type: SYSTEM_TYPE.TISC,
        logo: "/logo/revenue.svg",
        name: PERMISSION_TITLE.ADMINISTRATION_REVENUE,
        accessable: false,
        created_at: moment(),
        number: 17,
        parent_number: 12,
        routes: [
          { id: "88", accessable: false },
          { id: "89", accessable: false },
          { id: "90", accessable: false },
          { id: "91", accessable: false },
          { id: "95", accessable: false },
        ],
      },
    ];

    records.forEach(async (record) => {
      await db.query({
        query: `insert ${JSON.stringify(record)} into @@model`,
        bindVars: {
          "@model": "permissions",
        },
      });
    });
    console.log("success seed tisc permssion data");
  };
  try {
    await createAndSeed(permissionCollection);
  } catch (error) {
    if (error.message === "duplicate name") {
      await permissionCollection.drop();
      await createAndSeed(permissionCollection);
    }
  }
};

module.exports = {
  seed,
};
